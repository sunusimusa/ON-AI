<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tele AI Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PAYSTACK -->
  <script src="https://js.paystack.co/v1/inline.js"></script>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#2563eb" />

  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <h2>ü§ñ Tele AI Chat</h2>

  <!-- CHAT AREA -->
  <div id="chatBox" style="border:1px solid #ccc;padding:10px;height:250px;overflow-y:auto;"></div>

  <!-- INPUT -->
  <textarea id="message" placeholder="Rubuta sakonka..." style="width:100%;height:80px;"></textarea>

  <button id="sendBtn">Send Message</button>

  <p id="status"></p>

  <hr>

  <!-- PRO BUTTONS -->
  <button class="proBtn" data-days="7" data-amount="500">Upgrade ‚Ç¶500 (1 week)</button>
  <button class="proBtn" data-days="14" data-amount="900">Upgrade ‚Ç¶900 (2 weeks)</button>
  <button class="proBtn" data-days="30" data-amount="1500">Upgrade ‚Ç¶1500 (1 month)</button>

  <hr>

  <!-- ADS (SAFE PLACE) -->
  <div id="ads" style="margin-top:20px;text-align:center">
    <small>Advertisement</small><br>
    <!-- üîΩ SAKA ADS SCRIPT ANAN üîΩ -->
  </div>

  <!-- ================= JS ================= -->
  <script>
    const chatBox = document.getElementById("chatBox");
    const sendBtn = document.getElementById("sendBtn");
    const msgInput = document.getElementById("message");
    const statusEl = document.getElementById("status");

    // SEND MESSAGE
    sendBtn.onclick = async () => {
      const text = msgInput.value.trim();
      if (!text) return;

      chatBox.innerHTML += `<div><b>You:</b> ${text}</div>`;
      msgInput.value = "";
      statusEl.innerText = "‚è≥ AI na tunani...";

      try {
        const res = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();

        if (data.reply) {
          chatBox.innerHTML += `<div><b>AI:</b> ${data.reply}</div>`;
          statusEl.innerText = "";
          chatBox.scrollTop = chatBox.scrollHeight;
        } else {
          statusEl.innerText = "‚ùå Error daga AI";
        }
      } catch (e) {
        statusEl.innerText = "‚ùå Network error";
      }
    };

    // UPGRADE BUTTONS
    document.querySelectorAll(".proBtn").forEach(btn => {
      btn.onclick = () => {
        const days = btn.dataset.days;
        const amount = btn.dataset.amount;

        const handler = PaystackPop.setup({
          key: "pk_live_SAKA_PUBLIC_KEY_DINKA",
          email: "user@teleai.app",
          amount: amount * 100,
          currency: "NGN",
          callback: function (response) {
            statusEl.innerText = "‚úÖ Payment successful, PRO activated!";
            // zaka iya kiran /verify-payment anan
          }
        });

        handler.openIframe();
      };
    });

    // SERVICE WORKER
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/sw.js");
    }
  </script>

</body>
</html>
